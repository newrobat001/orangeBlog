<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title >橙子技术社区</title>
    <!-- 标签页图标 -->
    <link rel="Shortcut Icon" href="../static/icon/logo.ico" type="image/x-icon"/>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Raleway:300,400%7COpen+Sans:400,400i,700%7CLibre+Baskerville:400i'
          rel='stylesheet'>
    <!-- Css -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/font-icons.css"/>
    <link rel="stylesheet" href="/css/sliders.css"/>
    <link rel="stylesheet" href="/css/style.css"/>
    <link rel="stylesheet" href="/css/responsive.css"/>
    <link rel="stylesheet" href="/css/spacings.css"/>
    <link rel="stylesheet" href="/css/animate.min.css"/>
    <link rel="stylesheet" href="/editor/plugins/editor.md/css/editormd.min.css"/>
    <style>
        .liked {
            background-color: #ff2a2a;
        }
    </style>
</head>

<body class="relative">

<!-- Preloader -->
<div class="loader-mask">
    <div class="loader">
        <div></div>
        <div></div>
    </div>
</div>

<div class="main-wrapper oh">

    <header class="nav-type-1 dark-nav">

        <!-- Fullscreen search -->
        <div class="search-wrap">
            <div class="search-inner">
                <div class="search-cell">
                    <form method="get">
                        <div class="search-field-holder">
                            <input type="search" class="form-control main-search-input" placeholder="Search for">
                            <div class="search-submit-icon"><i class="icon icon_search"></i></div>
                            <input type="submit" class="search-submit" value="search">
                        </div>
                    </form>
                </div>
            </div>
            <i class="icon icon_close search-close" id="search-close"></i>
        </div> <!-- end fullscreen search -->

        <nav class="navbar navbar-fixed-top">
            <div class="navigation">
                <div class="container relative">
                    <div class="row">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse"
                                    data-target="#navbar-collapse">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div> <!-- end navbar-header -->


                        <!-- side menu -->
                        <div class="side-menu nav-left hidden-sm hidden-xs">
                            <div class="nav-inner">
                                <div class="nav-search-wrap hidden-sm hidden-xs">
                                    <a href="#" class="nav-search search-trigger">
                                        <i class="icon icon_search"></i>
                                    </a>
                                </div>
                            </div>
                        </div> <!-- end side menu -->

                        <div class="col-md-12 nav-wrap">
                            <div class="collapse navbar-collapse text-center" id="navbar-collapse">

                                <ul class="nav navbar-nav">

                                    <li><a href="/">首页</a></li>
                                    <li><a th:href="@{/article/edit}">写博客</a></li>
                                    <li><a href="/contact.html">关于我</a></li>
                                    <li><a href="#" onclick="toggleBackgroundColor()">
                                        <i class="fa ">换个颜色</i></a></li>
                                    <!-- todo:登录 -->
                                    <!--                  <li><a id="login-a" href="/user/login.html" >登录</a></li>-->
                                    <li><a id="login-a" href="user/login"
                                           th:if="${session == null or session.user == null}" onclick="login()">登录</a>
                                    </li>
                                    <li><a id="login-b" th:href="@{'/user/info?id=' + ${session.userinfo.id}}"
                                           th:if="${session.user != null }" th:text="${session.user}">Username</a>
                                    </li>
                                    <li><a id="logout-a" th:href="@{/user/logout}"
                                           th:if="${session.user != null }">退出</a>
                                    </li>
                                    <!--th:text="${user.username}"-->
                                    <li id="mobile-search" class="hidden-lg hidden-md">
                                        <form method="get" class="mobile-search">
                                            <input type="search" class="form-control" placeholder="Search...">
                                            <button type="submit" class="search-button">
                                                <i class="icon icon_search"></i>
                                            </button>
                                        </form>
                                    </li>

                                </ul> <!-- end menu -->
                            </div> <!-- end collapse -->
                        </div> <!-- end col -->

                        <!-- side menu -->
                        <!-- end side menu -->

                    </div> <!-- end row -->
                </div> <!-- end container -->
            </div> <!-- end navigation -->
        </nav> <!-- end navbar -->
    </header>

    <section class="header-wrap bg-light">
        <div class="container">
            <div class="heading-row text-center mb-40">
                <h1 class="heading uppercase small">橙子技术社区</h1>
            </div>
        </div>
    </section>

    <div class="content-wrapper oh">

        <!-- Content -->
        <section class="content post-single pt-70 pt-mdm-60">
            <div class="container relative">
                <div class="row">

                    <!-- post content -->
                    <div class="col-md-9 post-content mb-50">

                        <!-- large post -->
                        <article class="entry-item large-post">

                            <div class="entry-header">

                                <p class="entry-category" th:text="'所属分类：'+${categoryById.categoryName}">类型</p>
                                <!--                  todo:文章详情标题-->
                                <!--                  model.addAttribute("singleArt",article)
                                             .addAttribute("singleDetail",detail);-->

                                <h1 th:text="${singleArt.title}">大标题</h1>
                            </div>

                            <!-- entry author -->
                            <div class="entry-author-box clearfix">
                                <img src="/img/default.jpg" class="author-img" alt="img"
                                     style="max-width: 50px; height: auto">
                                <div class="author-info">
                                    <h6 class="author-name"><a th:href="@{'/user/info?id='+${singleArt.userId}}" th:text="${author}">作者</a>
                                    </h6>
                                    <p class="mb-0">作者简介：这家伙很懒，什么都没写。
                                    </p>
                                </div>
                            </div>

                            <div class="entry-wrap">
                                <div class="entry">
                                    <div class="">
                                        <div class="" style="background-color: rgba(247,247,247,0.22)">
<!--                                            <div id="editormd" class="markdown-body editormd-preview-container"-->
<!--                                                 previewcontainer="true" style="padding: 20px;">-->
                                            <div id="test-editormd-view" >
                                                <textarea id="append-test" style="display:none;" th:text="${content}" >
                                                </textarea>
                                            </div>
                                        </div>

                                        <!-- tags -->
                                        <div class="entry-tags tags mb-50 mt-40 clearfix">
                                            <span th:each="tag : ${tags}">
                                                <a href="#" th:text="${tag.tagName}">Creative</a>
                                            </span>
                                        </div>

                                        <!-- 互动按钮 -->
                                        <div id="articleButton"  class="entry-meta-wrap clearfix">
                                            <div class="btn-group ">
                                                <input type="hidden" id="likeType" value="0" />

                                                <input th:if="${session} != null" type="hidden" id="UserId"  />


                                                <button id="likeButton"
                                                        type="button"
                                                        class="btn btn-light"
                                                        th:text="${'👍（' + likeCount + '）'}"

                                                >👍（743）</button>
                                                <button type="button" class="btn btn-light" th:text="${' 💬 （' +commentCount+ '）'}">💬 （2）
                                                    </button>
                                                <button type="button" class="btn btn-light">⭐（）</button>
                                                <button type="button" class="btn btn-light" data-toggle="collapse"
                                                        data-target="#allComments">  :  </button>
                                            </div>
                                        </div>


                                        <!-- 评论 -->
                                        <div id="allComments" class="collapse">
                                            <div class="entry-comments mt-20">
                                                <div class="heading-lines mb-30">
                                                    <h3 class="heading small">评论</h3>
                                                </div>

                                                <!-- 测试评论 -->
                                                <ul class="comment-list" th:each="comment : ${commentList}">
                                                    <li th:id="${'comment-' + comment.id}">
                                                        <div class="comment-body">
                                                            <img th:src=" '/img/default.jpg' " class="comment-avatar" alt="" style="max-width: 50px; height: auto">
                                                            <div class="comment-content">
                                                                <span class="comment-author" th:text="'[ '+${comment.userName}+' ]'"></span>
                                                                <span class="comment-date" th:text="${comment.createTime}"></span>
                                                                <strong><span th:text="${comment.content}"></span></strong>

                                                                <div class="btn-group btn-group-sm">
                                                                    <button type="button" class="btn btn-light" th:text="${'👍（' + likeCount + '）'}">
                                                                        👍（）
                                                                    </button>

                                                                    <button type="button" class="btn btn-light" th:text="${' 💬（' + commentList.size() + '）'}"></button>
                                                                    <button type="submit" class="btn btn-light" >回复</button>
                                                                    <button type="button"
                                                                            class="btn btn-light"
                                                                            data-toggle="collapse"
                                                                            th:data-target="${'#reply-' + comment.id}"
                                                                            th:if="${comment.child != null and comment.child.size() > 0}">
                                                                        :  ️
                                                                    </button>
                                                                </div>

                                                                <div class="comment-form mt-60" >

                                                                    <form id="a-form" method="post" action="#">
                                                                        <div class="row row-16">
                                                                            <div class="col-md-12">
                                                                            <textarea name="comment" id="a-comment" placeholder="请文明友善发言，否则将会移除哦"
                                                                                      rows="1">

                                                                            </textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="btn-group btn-group-sm">
                                                                            <button type="submit" class="btn btn-light" >回复</button>
                                                                        </div>
                                                                    </form>
                                                                </div>

                                                            </div>
                                                        </div>

                                                        <ul th:id="${'reply-' + comment.id}" class="comment-reply collapse">
                                                            <li th:each="reply : ${comment.child}">
                                                                <div class="comment-body">
                                                                    <img th:src=" '/img/default.jpg' " class="comment-avatar" alt="" style="max-width: 50px; height: auto">
                                                                    <div class="comment-content">
                                                                        <span class="comment-author" th:text="'[ '+${reply.userName}+' ]'"></span>
                                                                        <span class="comment-date" th:text="${reply.createTime}"></span>
                                                                        <strong><span th:text="${reply.content}"></span></strong>
                                                                        <div class="btn-group btn-group-sm">
                                                                            <button type="button" class="btn btn-light" th:text="${'👍（' + likeCount + '）'}">
                                                                                👍（）
                                                                            </button>
                                                                            <button type="button" class="btn btn-light">回复</button>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </li> <!-- end reply comment -->

                                                            <li th:each="reply2 : ${comment.th}">
                                                                <div class="comment-body">
                                                                    <img th:src=" '/img/default.jpg' " class="comment-avatar" alt="" style="max-width: 50px; height: auto">
                                                                    <div class="comment-content">
                                                                        <span class="comment-author" th:text="'[ '+${reply2.userName}+' ] 回复 [ '+ ${reply2.parentName}+' ]'"></span>
                                                                        <span class="comment-date" th:text="${reply2.createTime}"></span>
                                                                        <strong><span th:text="${reply2.content}"></span></strong>
                                                                        <div class="btn-group btn-group-sm">
                                                                            <button type="button" class="btn btn-light" th:text="${'👍（' + likeCount + '）'}">
                                                                                👍（）
                                                                            </button>
                                                                            <button type="button" class="btn btn-light">回复</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </li> <!-- end reply comment -->
                                                        </ul>
                                                        </ul>
                                                    </li> <!-- end comment -->
                                                </ul>


                                            </div> <!--  end comments -->

                                            <!-- 发评论 -->
                                            <div class="comment-form mt-60">
                                                <div class="heading-lines mb-30">
                                                    <h3 class="heading small">留下你的想法</h3>
                                                </div>
                                                <form id="form" method="post" action="#">
                                                    <div class="row row-16">
                                                        <div class="col-md-12">
                                                            <textarea name="comment" id="comment" placeholder="请文明友善发言，否则将会移除哦"
                                                                      rows="1"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="btn-group btn-group-sm">
                                                    <button type="submit" class="btn btn-light" >回复</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </article> <!-- end large post -->
                    </div> <!-- end col -->

                    <!-- 侧边推荐 -->
                    <aside th:replace="fragments/aside :: aside">
                    </aside> <!-- end sidebar -->
                </div> <!-- end row -->
            </div> <!-- end container -->
        </section> <!-- end content -->


        <!-- Footer Type-1 -->
        <footer class="footer footer-type-1 bg-dark">
            <div class="bottom-footer">
                <div class="container">
                    <div class="row">

                        <div class="col-sm-12 copyright text-center">
                <span>
                  Copyright &copy; 2017.Company name All rights reserved.
                </span>
                        </div>

                    </div>
                </div>
            </div>
        </footer> <!-- end footer -->


        <div id="back-to-top">
            <a href="#top"><i class="fa fa-angle-up"></i></a>
        </div>

    </div> <!-- end content wrapper -->
</div> <!-- end main wrapper -->

<!-- jQuery Scripts -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/plugins.js"></script>
<script type="text/javascript" src="/js/scripts.js"></script>
<script src="/editor/plugins/editor.md/js/editormd.min.js"></script>

<script src="/editor/plugins/editor.md/lib/marked.min.js"></script>
<script src="/editor/plugins/editor.md/lib/prettify.min.js"></script>

<script src="/editor/plugins/editor.md/lib/raphael.min.js"></script>
<script src="/editor/plugins/editor.md/lib/underscore.min.js"></script>
<script src="/editor/plugins/editor.md/lib/sequence-diagram.min.js"></script>
<script src="/editor/plugins/editor.md/lib/flowchart.min.js"></script>
<script src="/editor/plugins/editor.md/lib/jquery.flowchart.min.js"></script>
<!-- SweetAlert2 -->
<script src="/editor/plugins/sweetalert2/sweetalert2.min.js"></script>
<script src="/editor/plugins/editor.md/js/editormd.min.js"></script>
<!-- Instafeed -->
<script type="text/javascript">

        var userId = $('#UserId').val();
        var type = $('#likeType').val();
        var status = false;

        // 点击按钮时触发的事件
        $('#likeButton').click(function() {
        // 获取用户ID、类型和状态

        status = !status;
        // 获取按钮元素
        var button = document.getElementById('likeButton');
        // 根据状态设置按钮颜色
        if (status) {
            // 如果是喜欢状态，添加一个自定义的 CSS 类
            button.classList.add('liked');

            $('#likeButton').text('👍（' + [[${likeCount+1}]] + '）');

            $.ajax({
                type: 'GET',  // 可根据实际情况修改为 'GET'
                url: '/userfoot/like',
                data: {
                    userId: userId,
                    type: type,
                    status: status
                },
                success: function(response) {
                },
                error: function(error) {
                    // 处理错误
                    console.error('Failed to send like request:', error);
                }
            });
        } else {
           // 如果不是喜欢状态，移除自定义的 CSS 类
           button.classList.remove('liked');

            $('#likeButton').text('👍（' + [[${likeCount-1}]] + '）');
        }
        // 发送 AJAX 请求

    });

        $('#commentButton').click(function() {
            // 获取用户ID、类型和状态
            var userId = $('#UserId').val();
            var type = $('#likeType').val();
            var status = false;
            status = !status;
            // 获取按钮元素
            var button = document.getElementById('likeButton');
            // 根据状态设置按钮颜色
            if (status) {
                // 如果是喜欢状态，添加一个自定义的 CSS 类
                button.classList.add('liked');

                $('#likeButton').text('👍（' + [[${likeCount+1}]] + '）');
            } else {
                // 如果不是喜欢状态，移除自定义的 CSS 类
                button.classList.remove('liked');

                $('#likeButton').text('👍（' + [[${likeCount-1}]] + '）');
            }
            // 发送 AJAX 请求
            $.ajax({
                type: 'GET',  // 可根据实际情况修改为 'GET'
                url: '/userfoot/like',
                data: {
                    userId: userId,
                    type: type,
                    status: status
                },
                success: function(response) {
                },
                error: function(error) {
                    // 处理错误
                    console.error('Failed to send like request:', error);
                }
            });
        });

        $(function() {
            var testEditormdView;

            testEditormdView2 = editormd.markdownToHTML("test-editormd-view", {
                htmlDecode      : "style,script,iframe",  // you can filter tags decode
                emoji           : true,
                taskList        : true,
                tocm            : true,    // Using [TOCM]
                tex             : true,  // 默认不解析
                flowChart       : true,  // 默认不解析
                sequenceDiagram : true,  // 默认不解析
            });
        });
</script>


</body>
</html>
